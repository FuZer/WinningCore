<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>문의 - WinningCore</title>
    <link rel="stylesheet" href="../assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- EmailJS CDN -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        /* 로딩 스피너 스타일 */
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 메시지 스타일 */
        .form-message {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 5px;
            display: none;
        }
        
        .form-message.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .form-message.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* 버튼 비활성화 스타일 */
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <!-- 네비게이션 -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="/">
                        <img src="../assets/images/logo.png" alt="WinningCore Logo" class="logo-image">
                    </a>
                </div>
                <nav class="nav">
                    <ul class="nav-list">
                        <li><a href="/">Home</a></li>
                        <li><a href="/about">About</a></li>
                        <li class="dropdown">
                            <a href="/services" class="dropdown-toggle">Services <i class="fas fa-chevron-down"></i></a>
                            <ul class="dropdown-menu">
                                <li><a href="/services#proposal-consulting">전략 컨설팅</a></li>
                                <li><a href="/services#speech-coaching">스피치 컨설팅</a></li>
                                <li><a href="/services#professional-presenter">전문 프레젠터 지원</a></li>
                                <li><a href="/services#training-education">역량 강화 교육</a></li>
                            </ul>
                        </li>
                        <li><a href="/contact">Contact</a></li>
                    </ul>
                </nav>
                <div class="mobile-menu-btn">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>
    <section class="contact">
        <div class="container">
            <div class="contact-content">
                <div class="contact-left">
                    <div class="contact-logo">
                        <img src="../assets/images/logo.png" alt="WinningCore Logo" class="contact-logo-image">
                    </div>
                    <div class="contact-info">
                        <h3>Contact</h3>
                        <p>제안서 · 발표 · 투자 피칭 관련 문의사항은<br>양식을 통해 편하게 보내주세요.</p>
                        <p style="margin-top: 1.5rem; opacity: 0.9;">WinningCore는 당신의 이야기를 이해하고,<br>실전에서 통하는 전략으로 함께 해답을 만들어갑니다.</p>
                    </div>
                </div>
                <div class="contact-right">
                    <div class="contact-form">
                        <div class="form-header">
                            <h3>문의 양식</h3>
                            <p>아래 양식을 작성해 주시면 빠른 시일 내에 연락드리겠습니다.</p>
                        </div>
                        <form id="contactForm">
                            <div class="form-section">
                                <h4>기본 정보</h4>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="company">회사명 <span class="required">*</span></label>
                                        <input type="text" id="company" name="company" required placeholder="회사명을 입력해주세요">
                                    </div>
                                    <div class="form-group">
                                        <label for="name">담당자 <span class="required">*</span></label>
                                        <input type="text" id="name" name="name" required placeholder="성함과 직위를 입력해주세요">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="email">이메일 <span class="required">*</span></label>
                                        <input type="email" id="email" name="email" required placeholder="example@company.com">
                                    </div>
                                    <div class="form-group">
                                        <label for="phone">연락처 <span class="required">*</span></label>
                                        <input type="tel" id="phone" name="phone" required placeholder="010-0000-0000">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-section">
                                <h4>서비스 문의</h4>
                                <div class="form-group">
                                    <label for="service">관심 서비스 <span class="required">*</span></label>
                                    <select id="service" name="service" required>
                                        <option value="">서비스를 선택해주세요</option>
                                        <option value="proposal">제안서 컨설팅</option>
                                        <option value="pt">PT 컨설팅</option>
                                        <option value="speech-coaching">스피치 컨설팅</option>
                                        <option value="ir">IR 피칭 컨설팅</option>
                                        <option value="presenter">전문 프레젠터 지원</option>
                                        <option value="edu">맞춤형 교육 프로그램</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="message">문의 내용 <span class="required">*</span></label>
                                    <textarea id="message" name="message" rows="6" required placeholder="구체적인 문의사항을 상세히 작성해주세요.&#10;예시:&#10;- 현재 상황 및 고민사항&#10;- 원하는 결과물&#10;- 일정 및 예산 범위"></textarea>
                                </div>
                            </div>
                            
                            <div class="form-submit">
                                <button type="submit" class="btn btn-primary" id="submitBtn">
                                    <div class="loading-spinner" id="loadingSpinner"></div>
                                    <i class="fas fa-paper-plane" id="submitIcon"></i>
                                    <span id="submitText">문의하기</span>
                                </button>
                                <div class="form-notice">
                                    <i class="fas fa-info-circle"></i>
                                    <p>※ 문의사항이 바로 담당자에게 전달됩니다.<br>
                                    영업일 기준 1-2일 내에 답변드리겠습니다.</p>
                                </div>
                                <div class="form-message" id="formMessage"></div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- 푸터 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <img src="../assets/images/logo.png" alt="WinningCore Logo" class="footer-logo-image">
                    </div>
                    <p>제안과 발표, 실전 전략의 모든 것<br>수주 제안의 전략 파트너 _ 위닝코어</p>
                </div>
                <div class="footer-section">
                    <h4>About</h4>
                    <ul>
                        <li><a href="/about">Company</a></li>
                        <li><a href="/about">Reference</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Services</h4>
                    <ul>
                        <li><a href="/services#proposal-consulting">제안서 컨설팅</a></li>
                        <li><a href="/services#proposal-consulting">PT 컨설팅</a></li>
                        <li><a href="/services#proposal-consulting">IR 피칭 컨설팅</a></li>
                        <li><a href="/services#speech-coaching">제안 발표자 코칭</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Training</h4>
                    <ul>
                        <li><a href="/services#speech-coaching">비즈니스 스피치 코칭</a></li>
                        <li><a href="/services#training-education">전문 발표자 지원</a></li>
                        <li><a href="/services#training-education">맞춤형 교육 프로그램</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Contact</h4>
                    <ul>
                        <li><a href="/contact">이메일 문의</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Copyright © 2025 위닝코어. All rights reserved.</p>
            </div>
        </div>
    </footer>
    <script src="../assets/js/main.js"></script>
    <script>
        // EmailJS 초기화 
        (function(){
            emailjs.init({
                publicKey: "nLHMiEqWlIY52Z1pC", 
            });
        })();

        // 추가 보안: 페이지 이탈 시 확인 (폼 작성 중일 때)
        let formChanged = false;
        document.getElementById('contactForm').addEventListener('input', function() {
            formChanged = true;
        });
        
        window.addEventListener('beforeunload', function(e) {
            if (formChanged) {
                e.preventDefault();
                e.returnValue = '작성 중인 내용이 있습니다. 페이지를 떠나시겠습니까?';
            }
        });

        // 폼 제출 처리
        document.getElementById('contactForm').addEventListener('submit', function(event) {
            event.preventDefault();
            
            // 폼 제출 시 formChanged 플래그 리셋
            formChanged = false;
            
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const submitIcon = document.getElementById('submitIcon');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const formMessage = document.getElementById('formMessage');
            
            // 버튼 상태 변경 (로딩)
            submitBtn.disabled = true;
            submitText.textContent = '전송 중...';
            submitIcon.style.display = 'none';
            loadingSpinner.style.display = 'inline-block';
            formMessage.style.display = 'none';
            
            // 폼 데이터 검증 강화
            const company = document.getElementById('company').value.trim();
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const service = document.getElementById('service').value;
            const message = document.getElementById('message').value.trim();
            
            // 기본 검증
            if (!company || !name || !email || !phone || !service || !message) {
                formMessage.className = 'form-message error';
                formMessage.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 모든 필수 항목을 입력해주세요.';
                formMessage.style.display = 'block';
                
                // 버튼 상태 복원
                submitBtn.disabled = false;
                submitText.textContent = '문의하기';
                submitIcon.style.display = 'inline-block';
                loadingSpinner.style.display = 'none';
                return;
            }
            
            // 이메일 형식 검증
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                formMessage.className = 'form-message error';
                formMessage.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 올바른 이메일 형식을 입력해주세요.';
                formMessage.style.display = 'block';
                
                // 버튼 상태 복원
                submitBtn.disabled = false;
                submitText.textContent = '문의하기';
                submitIcon.style.display = 'inline-block';
                loadingSpinner.style.display = 'none';
                return;
            }
            
            // 폼 데이터 수집
            const templateParams = {
                company: company,
                name: name,
                email: email,
                phone: phone,
                service: service,
                message: message,
                timestamp: new Date().toLocaleString('ko-KR') // 전송 시간 추가
            };
            
            // EmailJS로 이메일 전송 (Template ID 수정 필요!)
            emailjs.send('service_o6hl33l', 'template_7in1de9', templateParams)
                .then(function(response) {
                    console.log('SUCCESS!', response.status, response.text);
                    
                    // 성공 메시지 표시
                    formMessage.className = 'form-message success';
                    formMessage.innerHTML = '<i class="fas fa-check-circle"></i> 문의가 성공적으로 전송되었습니다! 빠른 시일 내에 연락드리겠습니다.';
                    formMessage.style.display = 'block';
                    
                    // 폼 초기화
                    document.getElementById('contactForm').reset();
                    
                    // 성공 시 스크롤을 메시지로 이동
                    formMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                }, function(error) {
                    console.log('FAILED...', error);
                    
                    // 오류 메시지 표시
                    formMessage.className = 'form-message error';
                    formMessage.innerHTML = '<i class="fas fa-exclamation-triangle"></i> 전송 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.';
                    formMessage.style.display = 'block';
                })
                .finally(function() {
                    // 버튼 상태 복원
                    submitBtn.disabled = false;
                    submitText.textContent = '문의하기';
                    submitIcon.style.display = 'inline-block';
                    loadingSpinner.style.display = 'none';
                });
        });
    </script>
</body>
</html> 